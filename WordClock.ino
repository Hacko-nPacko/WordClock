#include "LPD8806.h"
#include "SPI.h"
#include "Process.h"
#include <avr/pgmspace.h>

const uint8_t boards[144][18] PROGMEM = {
  /*  1:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  1:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:10 */ { B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  2:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B10000000, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:10 */ { B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B01111110, B00000000, B11111010 },
  /*  3:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  3:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00010000, B00000000, B11100000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  4:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B11111010 },
  /*  4:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  4:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00000000, B01111110, B00000000, B11111010 },
  /*  5:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  5:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  5:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10001110, B00000000, B00000000, B00000000, B11111010 },
  /*  6:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:10 */ { B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B11111010 },
  /*  6:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  6:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00010000, B00011110, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  7:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B11111010 },
  /*  7:05 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00010001, B11110000, B11111010 },
  /*  7:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00001111, B00000000, B00000000, B11111010 },
  /*  7:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  7:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010001, B11110000, B11111010 },
  /*  8:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B11111010 },
  /*  8:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  8:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000000, B00001111, B00000000, B00000000, B11111010 },
  /*  9:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /*  9:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /*  9:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10000001, B11110000, B00000000, B00000000, B11111010 },
  /* 10:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:10 */ { B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 10:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00010011, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:10 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000011, B11100000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 11:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:00 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:05 */ { B00000000, B00000000, B00000000, B00000000, B00001110, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:10 */ { B00000000, B00000000, B00000000, B00000000, B00000001, B11110000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:15 */ { B01111111, B11000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:20 */ { B00000000, B00000001, B11111100, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:25 */ { B00000001, B11000001, B11111110, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:30 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00111111, B11000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:35 */ { B00000001, B11000000, B00000010, B00001111, B11100000, B00000000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:40 */ { B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000111, B11111100, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:45 */ { B01111111, B11000000, B00000000, B01110000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000001, B11100000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:50 */ { B00000000, B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 },
  /* 12:55 */ { B00000001, B11000000, B00000010, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, B10111111, B11100000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B11111010 }
};

#define DATA_PIN 5
#define CLOCK_PIN 4
#define PHOTOCELL_PIN A0
int led = 127;

LPD8806 strip = LPD8806(144, DATA_PIN, CLOCK_PIN);
Process date;                 // process used to get the date
int idx = -1;
int minuteIdx = -1;
int lightLevel = -1;

void setup() {
  // Start up the LED strip
  strip.begin();
  
  // No surprise, but the Arduino is OK if we got here
  strip.setPixelColor(132, 0, 127, 0); //A Arduino is ok

  strip.show();

  Bridge.begin();       // Initialize the Bridge
  Console.begin();   
//  while (!Console); 
  
  Console.println("Starting"); 
  strip.setPixelColor(133, 0, 127, 0); //A Arduino is ok
  strip.show();
  delay(500);  

  // Use the "E" to show the light in the room in three levels
  lightLevel = readlightLevel();
  if (lightLevel == 3) {
    strip.setPixelColor(139, 127, 0, 0); //E
  }
  if (lightLevel == 2) {
    strip.setPixelColor(139, 0, 127, 0); //E
  }
  if (lightLevel == 1) {
    strip.setPixelColor(139, 0, 0, 127); //E
  }
  strip.show();

  waitUntilIPisup();
  strip.setPixelColor(134, 0, 127, 0); //A Arduino is ok
  strip.show();
  delay(500);  

  // Now check the WLAN signal status
  displayWLANSignal();
  strip.setPixelColor(135, 0, 127, 0); //DHCP
  strip.show();
  delay(500);

  if (checkGoogle() == 1) {
    strip.setPixelColor(136, 0, 127, 0); //I Internet connection
  } else {
    strip.setPixelColor(136, 0, 0, 127); //I Internet connection problem
  }
  strip.show();
  delay(500);

  waitUntilNTPisup();
  strip.setPixelColor(137, 0, 127, 0); //N NTP is running
  strip.show();
  delay(500);
}

void displayWLANSignal() {
  Process p;
  p.runShellCommand("/usr/bin/clock/wifi");

  // do nothing until the process finishes, so you get the whole output:
  while (p.running());
  int signal = -1;
  // Read command output. runShellCommand() should have passed "Signal: xx&":
  while (p.available()) {
    int result = p.parseInt();          // look for an integer
    int signal = map(result, 0, 100, 0, 6);   // map result from 0-100 range to 0-7

    if (signal == 0) {
      strip.setPixelColor(131, 127, 0, 0);
    }
    if (signal > 0) {
      strip.setPixelColor(131, 0, 127, 0);
    }
    if (signal > 1) {
      strip.setPixelColor(130, 0, 127, 0);
    }
    if (signal > 2) {
      strip.setPixelColor(129, 0, 127, 0);
    }
    if (signal > 3) {
      strip.setPixelColor(128, 0, 127, 0);
    }
    if (signal > 4) {
      strip.setPixelColor(127, 0, 0, 127);
    }
    if (signal > 5) {
      strip.setPixelColor(126, 0, 0, 127);
    }
    strip.show();
    delay(100);
    if (signal > 0) break;

  }
}

int checkGoogle() {
  Process p;

  p.runShellCommand("/usr/bin/clock/ping");
  // do nothing until the process finishes, so you get the whole output:
  while (p.running());
  // Read command output. runShellCommand() mat have passed some text
  while (p.available()) {
    int retVal = p.parseInt();
    if (retVal == 4) return 1; // All pings OK
    return 0;  // Not Ok
  }

}
// This function checks if we have a valid IP address
void waitUntilIPisup() {
  Process p;
  int retval = 0;
  while (retval == 0) {
    p.runShellCommand("/usr/bin/clock/ip");
    // do nothing until the process finishes, so you get the whole output:
    while (p.running());

    // Read command output. runShellCommand() should have passed a number
    while (p.available()) {
      retval = p.parseInt();          // look for an integer
      if (retval != 0) break;
    }
  }
}

void waitUntilNTPisup() {
  int numpeers = 0;
  while (numpeers < 1) {
    Process p;
    // Check the number of ntp peers that is up and running
    p.runShellCommand("/usr/bin/clock/ntp");

    // do nothing until the process finishes, so you get the whole output:
    while (p.running());

    // Read command output. runShellCommand() should have passed a number
    while (p.available()) {
      numpeers = p.parseInt();          // look for an integer
      if (numpeers > 0) break;
    }
  }
}

void readtime() {
  int hours, minutes;

  if (!date.running())  {
    date.begin("date");
    date.addParameter("+%l:%M:%S");
    date.run();
  }

  while (date.available() > 0) {
    String timeString = date.readString();
    Console.print(timeString);
    // get the substrings for hour, minute second:
    String hourString = timeString.substring(0, 2);
    String minString = timeString.substring(3, 5);
    // String secString = timeString.substring(6, 8);

    hourString.trim();
    minString.trim();
    hours = hourString.toInt();
    minutes = minString.toInt();
    
  }

  int thisIdx = hours*12 + (minutes / 5) - 12;

  int level = readlightLevel();
  if (thisIdx != idx) {
    Console.println("Setting new time");
    idx = thisIdx;
    lightLevel = level;
    minuteIdx = 0;
    showtime();
  } else {
    if (level != lightLevel) {
      Console.println("Adjusting light");
      lightLevel = level;
      showtime();
    }
    if ((minutes % 5) != minuteIdx) {
      Console.println("Adjusting minutes");
      minuteIdx = minutes % 5;
      showtime();
    }
  }
}

void showtime() {
  // Clear strip
  clearstrip();

  int lights = 0;
  for (int i = 0; i < strip.numPixels()/8; i++) {
    uint8_t byt = pgm_read_byte(&boards[idx][i]);
    for (int j = 0; j < 8; j++) {
      uint8_t color = (byt & (B10000000 >> j)) > 0 ? led : 0;
      if (color > 0) {
        if (i < 17) {
          strip.setPixelColor((i * 8) + j, 0, 0, color);
        } else {
          if (lights < minuteIdx) {
            strip.setPixelColor((i * 8) + j, 0, 0, color);
          } else {
            strip.setPixelColor((i * 8) + j, 0, 0, 10);
          }
          lights++;
        }
      }
    }
  }
  strip.show();
}

void loop() {
  if (Console.available() > 0) {
    int newIdx = Console.parseInt();
    while (Console.read() != '\n');
    idx = newIdx;
    showtime();
    delay(1500);
  }
  readtime();
}

void clearstrip() {
  // Clear strip data before start of next effect
  for (int i = 0; i < strip.numPixels(); i++) {
    strip.setPixelColor(i, 0);
  }
}

int readlightLevel() {
  int photocellReading = analogRead(PHOTOCELL_PIN);
  Console.print("photo reading: ");
  Console.println(photocellReading);

  int level = 0;
  if (photocellReading < 450) {
    led = 32;
    level = 1;
  } else if (photocellReading < 870) {
    led = 96;
    level = 2;
  } else {
    led = 127;
    level = 3;
  }

  return level;
}
